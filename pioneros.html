<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Transferencias</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            max-width: 800px;
        }
        .card {
            background: #ffffff;
        }
    </style>
</head>
<body>
<div class="container py-5">
    <h1 class="text-center mb-4">Registro de Transferencias</h1>

    <!-- Formulario de Transferencias -->
    <form id="transferForm" class="card p-4 mb-5 shadow-sm">
        <div class="mb-3">
            <label for="region" class="form-label">Región</label>
            <select name="region" id="region" class="form-select" required>
                <option value="">Seleccione una región</option>
                <option value="Armenia">Armenia</option>
                <option value="Calarcá">Calarcá</option>
                <option value="Manizales">Manizales</option>
                <option value="Pereira">Pereira</option>
                <option value="Medellín">Medellín</option>
                <option value="Bogotá">Bogotá</option>
                <option value="Cali">Cali</option>
                <option value="Barcelona">Barcelona</option>
            </select>
        </div>

        <div class="mb-3">
            <label for="user" class="form-label">Usuario Encargado</label>
            <input type="text" name="user" id="user" class="form-control" required>
        </div>

        <div class="mb-3">
            <label for="details" class="form-label">Detalles</label>
            <textarea name="details" id="details" class="form-control" rows="3" required></textarea>
        </div>

        <div class="mb-3">
            <label for="tokens" class="form-label">Tokens Transferidos</label>
            <input type="number" name="tokens" id="tokens" class="form-control" min="1" required>
        </div>

        <button type="submit" class="btn btn-primary w-100">Registrar Transferencia</button>
    </form>

    <!-- Historial de Transferencias -->
    <h2 class="text-center">Historial de Transferencias</h2>
    <table id="transferTable" class="table table-striped mt-4">
        <thead>
            <tr>
                <th>Región</th>
                <th>Total Tokens</th>
                <th>Saldo por Cobrar</th>
            </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
            <tr>
                <th>Total</th>
                <th id="totalTokens">0</th>
                <th id="totalSaldo">$0.00</th>
            </tr>
        </tfoot>
    </table>
</div>

<script>
    // Inicializar datos desde localStorage
    const transfers = JSON.parse(localStorage.getItem('transfers')) || [];

    const form = document.getElementById('transferForm');
    const tableBody = document.querySelector('#transferTable tbody');
    const totalTokensEl = document.getElementById('totalTokens');
    const totalSaldoEl = document.getElementById('totalSaldo');

    // Actualizar tabla y totales
    function updateTable() {
        tableBody.innerHTML = '';
        let totalTokens = 0;
        let totalSaldo = 0;

        transfers.forEach(transfer => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${transfer.region}</td>
                <td>${transfer.tokens}</td>
                <td>$${(transfer.tokens * 100).toFixed(2)}</td>
            `;
            tableBody.appendChild(row);
            totalTokens += transfer.tokens;
            totalSaldo += transfer.tokens * 100;
        });

        totalTokensEl.textContent = totalTokens;
        totalSaldoEl.textContent = `$${totalSaldo.toFixed(2)}`;
    }

    // Manejar el envío del formulario
    form.addEventListener('submit', event => {
        event.preventDefault();

        const region = document.getElementById('region').value;
        const user = document.getElementById('user').value;
        const details = document.getElementById('details').value;
        const tokens = parseInt(document.getElementById('tokens').value, 10);

        if (region && user && details && tokens > 0) {
            const transfer = { region, user, details, tokens, date: new Date().toISOString() };
            transfers.push(transfer);
            localStorage.setItem('transfers', JSON.stringify(transfers));
            form.reset();
            updateTable();
        } else {
            alert('Todos los campos son obligatorios.');
        }
    });

    // Cargar tabla al iniciar
    updateTable();
</script>
</body>
</html>
